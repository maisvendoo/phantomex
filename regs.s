/*------------------------------------------------------------------------------
//      Function for read CR0
//----------------------------------------------------------------------------*/
.global	read_cr0

read_cr0:
    
      mov	%cr0, %eax
      ret
      
/*------------------------------------------------------------------------------
//      Function for write CR0
//----------------------------------------------------------------------------*/      
.global	write_cr0

write_cr0:

      push	%ebp
      mov	%esp, %ebp
      mov	8(%ebp), %eax
      mov	%eax, %cr0
      pop	%ebp
      
      ret

/*------------------------------------------------------------------------------
//      Function for read CR3
//----------------------------------------------------------------------------*/
.global	read_cr3

read_cr3:
    
      mov	%cr3, %eax
      ret

/*------------------------------------------------------------------------------
//      Function for write CR3
//----------------------------------------------------------------------------*/      
.global	write_cr3

write_cr3:

      mov	4(%esp), %eax
      mov	%eax, %cr3      
      
      ret

/*------------------------------------------------------------------------------
//      Function for read CR2
//----------------------------------------------------------------------------*/      
.global	read_cr2

read_cr2:
    
      mov	%cr2, %eax
      ret

/*------------------------------------------------------------------------------
//      Function for read ESP
//----------------------------------------------------------------------------*/
.global read_esp
      
read_esp:

	  mov	%esp, %eax
	  ret
	  
/*------------------------------------------------------------------------------
//      Function for read EBP
//----------------------------------------------------------------------------*/
.global read_ebp
	  
read_ebp:

	  mov	%ebp, %eax
	  ret
	  
/*------------------------------------------------------------------------------
//      Function for read EIP
//----------------------------------------------------------------------------*/
.global read_eip

read_eip:
    
        pop     %eax
        jmp     *%eax
      
/*------------------------------------------------------------------------------
//      Function for read EIP
//----------------------------------------------------------------------------*/
.global read_eflags

read_eflags:
    
        pushf
        pop     %eax
        
        ret

	  	  